
<div class="container">
  <div class="row">
    <table class="table table-striped">
      <div>
        <%= render 'sort' %>
      </div>
      <thead>
        <tr>
          <th>ジャンルa</th>
          <th>タイトル</th>
          <th>紹介文</th>
          <th>アピールポイント</th>
          <th>詳細文</th>
        </tr>
      </thead>

      <tbody>
        <% posts.each do |post| %>
          <tr>
            <td><%= post.genre.genre_name %></td>
            <td>
              <%= link_to post_path(post.id) do %>
                <% if post.image.attached? %>
                  <%= image_tag post.image, size: "100x100" %>
                <% else %>
                  <%= image_tag 'default-image', size: "100x100" %>
                <% end %>
                <%= post.title %>
              <% end %>
            </td>
            <td><%= post.introduction %></td>
            <td><%= post.selling_point %></td>
            <td><%= post.detail %></td>
            <td>
              <% if current_customer.present? %>
                <div><%= render 'public/favorites/favorite_button', post: post %></div>
              <% else %>
                <div><%= render 'public/favorites/favorite_count', post: post %></div>
              <% end %>
            </td>
            <td>
              <!--削除済みのコメントをカウントしない-->
              <% comments = Comment.where(post_id: post.id).where(is_deleted: false) %>
              <%= link_to "#{comments.count} コメント", post_path(post) %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>